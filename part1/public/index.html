<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dog Walking Service</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
    <h1>Welcome to The Dog Walking Service</h1>
    <p>Here is our dog of the day:</p>
    <img id="DOTD" src="" alt="">

    <script>
    async function DOTD() {
        try {
            const response = await fetch('https://dog.ceo/api/breeds/image/random');
            const data = await response.message

            document.getElementById('DOTD').src = data.json();

        } catch {
            console.error("Cannot get image at this time");
        }
    }

    window.onload = DOTD;


    const { createApp, ref, onMounted } = Vue;

    createApp({
      setup() {
        const form = ref({
          dog_id: '',
          requested_time: '',
          duration_minutes: '',
          location: ''
        });

        const walks = ref([]);
        // created a dogs variable where the data will be stored
        const dogs = ref([]);
        const message = ref('');
        const error = ref('');

        async function loadWalks() {
          try {
            const res = await fetch('/api/walks');
            walks.value = await res.json();
          } catch (err) {
            error.value = 'Failed to load walk requests';
          }
        }

        async function submitWalkRequest() {
          try {
            const res = await fetch('/api/walks', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(form.value)
            });
            const result = await res.json();

            if (!res.ok) throw new Error(result.error || 'Error submitting walk request');

            message.value = result.message;
            error.value = '';
            form.value = {
              dog_id: '',
              requested_time: '',
              duration_minutes: '',
              location: ''
            };
            loadWalks();
          } catch (err) {
            error.value = err.message;
            message.value = '';
          }
        }
// added loadDOTD
        async function loadDOTD() {
          try {
            const res = await fetch('https://dog.ceo/api/breeds/image/random');
            dotd.value = await res.json();
          } catch (err) {
            error.value = 'Failed to load dog of the day';
          }
        }

        onMounted(() => {
          // gets DOTD data straight away
          loadDOTD();
        });

        return {
          // added the dogs array here
          error,
        };
      }
    }).mount('#app');






    </script>
</body>
</html>
